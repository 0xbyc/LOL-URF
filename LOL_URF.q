[General]
SyntaxVersion=2
BeginHotkey=121
BeginHotkeyMod=0
PauseHotkey=19
PauseHotkeyMod=0
StopHotkey=123
StopHotkeyMod=0
RunOnce=1
EnableWindow=
MacroID=b7ef3493-910c-4579-8eef-eb9e5763c44c
Description=LOL无限火力连发助手WIN10可用 2019.02.17
Enable=1
AutoRun=0
[Repeat]
Type=0
Number=1
[SetupUI]
Type=1
QUI=Form
[Relative]
SetupOCXFile=
[Comment]
先设置好参数,F10启动,F12停止,每次修改参数后:
1.点击保存设置
2.点击终止(F12)
3.点击启动(F10)
WIN10如果没有作用,要添加数据执行保护,不会添加的请参考:
https://dwz.cn/OHvxN4jZ
更新日志:
2020-6-9
1. 修复部分win10版本上,按键检测失效

[UIPackage]
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


[Script]
// LOL 无限火力/无线乱斗 连发助手
// 保护键盘从我做起
// 功能还算比较完善的,不仅有QWER连发,也考虑到物品栏,额外增加4个键.
// 触发方式也有3种,WIN10也可以用.
// lyj
// 2019年2月17日
Global 连发间隔
连发间隔 = 0
Call 获取连发间隔
If 连发间隔 = 0 Then 
    连发间隔 = 5
End If
//键盘鼠标模拟方式 //0普通模拟 1硬件模拟 2超级模拟
SetSimMode 2
按键列表 = 获取按键设置()
//触发模式
If Form.OptionBox_按住空格触发连发.Value = 1 Then 
    Call 空格连发
ElseIf Form.OptionBox_自定义连发触发键.Value = 1 Then
    Call 自定义按键连发
ElseIf Form.OptionBox_开启则自动连发.Value = 1 Then
    Call 自动连发
End If
//////////////////////
//////////////////////
Function 空格连发
    Do 
        n = GetAsyncKeyState(32)
//        TracePrint n
        If n < 0 or n = 32769 Then 
//            TracePrint "按住不放"
            Call 按键(按键列表)
        Else 
//            TracePrint "空格松开"
        End If
        Delay 连发间隔
    Loop

End Function
//////////////////////
//////////////////////
Function 自定义按键连发
    Dim 按键码
    按键码 = 查询按键码 (Form.InputBox_自定义连发触发键.Text)
    Do 
        n = GetAsyncKeyState(按键码)
        If n < 0 or n = 32769 Then 
            //TracePrint "按住不放"
            Call 按键(按键列表)
            // Else 
            //TracePrint "松开"
        End If
        Delay 连发间隔
    Loop
End Function
//////////////////////
//////////////////////
Function 自动连发
    Do
        Call 按键(按键列表)
        Delay 连发间隔
    Loop
End Function
Function 按键 (按键列表)
    If UBound(按键列表) >= 0 Then 
        //鼠标
        If 按键列表(0) > 0 Then 
            LeftClick 1
        End If
        If 按键列表(1) > 0 Then 
            RightClick 1
        End If
        //键盘
        For i = 2 To UBound(按键列表)
            //TracePrint 按键列表(i)
            KeyPress 按键列表(i), 1
        Next
    End If 
End Function
//////////////////////
//////////////////////
Function 获取按键设置()
    Dim karr
    karr = Array(- 1 , - 1 , - 1 , - 1 , - 1 , - 1 , - 1 , - 1 , - 1 , - 1 )
    //鼠标左键
    If Form.CheckBox_鼠标左键.Value = 1 Then 
        karr(0) = 32769
    End If
    //鼠标右键
    If Form.CheckBox_鼠标右键.Value = 1 Then 
        karr(1) = 32773
    End If
    //Q键
    If Form.CheckBox_Q键.Value = 1 Then 
        karr(2) = 81
    End If
    //W键
    If Form.CheckBox_W键.Value = 1 Then 
        karr(3) = 87
    End If
    //E键
    If Form.CheckBox_E键.Value = 1 Then 
        karr(4) = 69
    End If
    //R键
    If Form.CheckBox_R键.Value = 1 Then 
        karr(5) = 82
    End If
    //自定义1
    If Form.CheckBox_自定义1.Value = 1 Then 
        karr(6) = Form.InputBox_自定义1.Text
    End If
    //自定义2
    If Form.CheckBox_自定义2.Value = 1 Then 
        karr(7) = Form.InputBox_自定义2.Text
    End If
    //自定义3
    If Form.CheckBox_自定义3.Value = 1 Then 
        karr(8) = Form.InputBox_自定义3.Text
    End If
    //自定义4
    If Form.CheckBox_自定义4.Value = 1 Then 
        karr(9) = Form.InputBox_自定义4.Text
    End If
    获取按键设置 = karr
End Function
//////////////////////
//////////////////////
Function 获取连发间隔
    连发间隔 = Form.InputBox_连发间隔.Text
End Function
//键盘某个按键按住检测函数
Declare Function GetAsyncKeyState Lib "user32" Alias "GetAsyncKeyState" (ByVal vKey As Long) As Integer
//通过按键查询按键码
Declare Function GetKeyNameText Lib "user32" Alias "GetKeyNameTextA" (ByVal lParam As Long, ByVal lpBuffer As String, ByVal nSize As Long) As Long
Declare Function MapVirtualKey Lib "user32" Alias "MapVirtualKeyA" (ByVal wCode As Long, ByVal wMapType As Long) As Long
Declare Function VkKeyScan Lib "user32" Alias "VkKeyScanA" (ByVal cChar As Byte) As Long
Declare Function GetKeyState Lib "user32" ALIAS "GetKeyState" (ByVal nVirtKey As Long) As Integer
Function 查询按键名(按键码)
    key = String(100, Chr(0))
    ajm = 0 + 按键码
    GetKeyNameText MapVirtualKey(ajm, 0) * 65536, key, 100
    Key = Left(key, InStr(key, Chr(0)) - 1)
    Select Case ajm
    Case 91
        key = "Win"
    Case 93
        key = "Right Mouse"
    Case 44
        key = "Print Screen"
    Case 19
        key = "Pause/Break"
    Case 144
        key = "Num Lock"
    Case 110
        Key = "Num ."
    Case 111
        Key = "Num /"
    Case 45
        key = "Insert"
    Case 46
        key = "Delete"
    Case 36
        key = "Home"
    Case 35
        key = "End"
    Case 33
        key = "PageUp"
    Case 34
        key = "PageDown"
    Case 37
        key = "Left"
    Case 38
        key = "Up"
    Case 39
        key = "Right"
    Case 40
        key = "Down"
    End Select
    查询按键名 = key
End Function
Function 查询按键码(按键名)
    Dim 控制键, 辅助键, 功能键, 方向键, 字母键, 数字键, 符号键, 组合键
    Dim rep, i, tmp, MatchEs, Match, shuliang, SubMatches, 子匹配数量, 子匹配
    控制键 = "CTRL 17，ALT 18，SHIFT 16，LEFT CTRL 162，LEFT ALT 164，LEFT SHIFT 160，RIGHT CTRL 163，RIGHT ALT 165，RIGHT SHIFT 161，WIN 91，RIGHT MOUSE 93"
    功能键 = "F1 112，F2 113，F3 114，F4 115，F5 116，F6 117，F7 118，F8 119，F9 120，F10 121，F11 122，F12 123，HOME 36，END 35，PAGEDOWN 34，PAGEUP 33，ESC 27，ENTER 13，SPACE 32，INSERT 45，DELETE 46，PRINT SCREEN 44，SCROLL LOCK 145，PAUSE/BREAK 19，BACKSPACE 8，TAB 9，CAPS LOCK 20"
    方向键 = "DOWN 40，UP 38，LEFT 37，RIGHT 39"
    字母键 = "A 65，B 66，C 67，D 68，E 69，F 70，G 71，H 72，I 73，J 74，K 75，L 76，M 77，N 78，O 79，P 80，Q 81，R 82，S 83，T 84，U 85，V 86，W 87，X 88，Y 89，Z 90"
    数字键 = "0 48，1 49，2 50，3 51，4 52，5 53，6 54，7 55，8 56，9 57"
    符号键 = "` 192，- 189，= 187，[ 219，] 221，\ 220，; 186，' 222，, 188，. 190，/ 191"
    小键盘 = "NUM LOCK 144，NUM 0 96，NUM 1 97，NUM 2 98，NUM 3 99，NUM 4 100，NUM 5 101，NUM 6 102，NUM 7 103，NUM 8 104，NUM 9 105，NUM * 106，NUM + 107，NUM - 109，NUM . 110，NUM / 111"
    多媒体 = "搜索 170，收藏 171，浏览器 172，静音 173，音量减 174，音量加 175，停止 179，邮件 180"
    组合键 = "，" & 控制键 & "，" & 功能键 & "，" & 方向键 & "，" & 字母键 & "，" & 数字键 & "，" & 符号键 & "，" & 小键盘 & "，"
    按键名 = Replace(按键名, "\", "\\")
    按键名 = Replace(按键名, ".", "\.")
    按键名 = Replace(按键名, "*", "\*")
    按键名 = Replace(按键名, "+", "\+")
    按键名 = Replace(按键名, "[", "\[")
    按键名 = Replace(按键名, "]", "\]")
    按键名 = Replace(按键名, " ", "\s")
    Set rep = New RegExp
    rep.IgnoreCase = True
    rep.[Global] = True
    rep.Pattern = "，"& 按键名 &"\s(\d+)，"
    Set MatchEs = rep.Execute(组合键)
    shuliang = Matches.count
    For Each Match In MatchEs
        tmp = tmp & Match.Value
        Set SubMatches = Match.SubMatches  '创建子匹配对象
        子匹配数量 = SubMatches.Count
        For i = 0 To 子匹配数量-1
            子匹配 = SubMatches.Item(i)
        Next
    Next
    查询按键码 = 0 + 子匹配
End Function
